---
import SiteLayout from "./SiteLayout.astro";

const {
  title = "Report",
  description = "",
  date = "",
  status = "",
  tags = [],
  youtubeId = "",
  youtubeChannelUrl = "https://www.youtube.com/@MikeBeyondParalysis" // change if needed
} = Astro.props;

const prettyDate = date ? new Date(date).toLocaleDateString("en-GB", { year: "numeric", month: "short", day: "numeric" }) : "";
---

<SiteLayout title={`${title} | Beyond Paralysis`} description={description}>
  <article class="report">
    <header class="hero">
      <h1>{title}</h1>
      {description && <p class="desc">{description}</p>}

      <div class="meta">
        {prettyDate && <span class="pill">Updated: {prettyDate}</span>}
        {status && <span class="pill">Status: {status}</span>}
        {tags?.length ? tags.map((t) => <span class="pill" aria-label={`Tag ${t}`}>{t}</span>) : null}
      </div>

      <div class="actions">
        {youtubeId && (
          <a class="btn" href={`https://www.youtube.com/watch?v=${youtubeId}`} target="_blank" rel="noreferrer">
            Watch the video
          </a>
        )}
        <a class="btn ghost" href={youtubeChannelUrl} target="_blank" rel="noreferrer">
          YouTube channel
        </a>
      </div>

      {youtubeId && (
        <div class="video">
          <iframe
            width="100%"
            height="420"
            src={`https://www.youtube.com/embed/${youtubeId}`}
            title="YouTube video player"
            frameborder="0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
            allowfullscreen>
          </iframe>
        </div>
      )}
    </header>

    <div class="content">
      <slot />
    </div>
  </article>
</SiteLayout>

<style>
  .report { max-width: 78ch; }
  .hero { margin-bottom: 18px; }
  .desc { font-size: 1.05rem; opacity: 0.85; }
  .meta { display: flex; flex-wrap: wrap; gap: 8px; margin: 12px 0; }
  .pill {
    font-size: 12px;
    border: 1px solid #e9e9e9;
    border-radius: 999px;
    padding: 6px 10px;
  }
  .actions { display: flex; gap: 10px; flex-wrap: wrap; margin: 12px 0 18px; }
  .btn {
    display: inline-block;
    text-decoration: none;
    border-radius: 12px;
    padding: 10px 12px;
    border: 1px solid #111;
    color: white;
    background: #111;
  }
  .btn.ghost { background: transparent; color: #111; border-color: #ddd; }
  .btn.ghost:hover { border-color: #111; }
  .video {
    margin-top: 14px;
    border: 1px solid #e9e9e9;
    border-radius: 14px;
    overflow: hidden;
  }

  /* Markdown typography */
  .content :global(h2) { margin-top: 26px; }
  .content :global(h3) { margin-top: 18px; }
  .content :global(p)  { line-height: 1.7; }
  .content :global(ul) { padding-left: 1.1rem; }
  .content :global(blockquote) {
    margin: 16px 0;
    padding: 12px 14px;
    border-left: 4px solid #111;
    background: #fafafa;
    border-radius: 10px;
  }
</style>
